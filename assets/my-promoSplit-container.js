var _=Object.defineProperty;var w=(s,n,e)=>n in s?_(s,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[n]=e;var h=(s,n,e)=>w(s,typeof n!="symbol"?n+"":n,e);import{i as S,x as v}from"./lit-element.js";const b="modulepreload",g=function(s){return"/"+s},p={},C=function(n,e,o){let a=Promise.resolve();if(e&&e.length>0){let l=function(i){return Promise.all(i.map(c=>Promise.resolve(c).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const t=document.querySelector("meta[property=csp-nonce]"),m=(t==null?void 0:t.nonce)||(t==null?void 0:t.getAttribute("nonce"));a=l(e.map(i=>{if(i=g(i),i in p)return;p[i]=!0;const c=i.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":b,c||(d.as="script"),d.crossOrigin="",d.href=i,m&&d.setAttribute("nonce",m),document.head.appendChild(d),c)return new Promise((f,y)=>{d.addEventListener("load",f),d.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${i}`)))})}))}function r(l){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=l,window.dispatchEvent(t),!t.defaultPrevented)throw l}return a.then(l=>{for(const t of l||[])t.status==="rejected"&&r(t.reason);return n().catch(r)})};class E extends S{constructor(){super();h(this,"_mySwiper",null);h(this,"_mq",null);h(this,"_productIndex",1);this.overlay_texts.forEach(e=>{e.addEventListener("click",()=>{this._productIndex=Number(e.dataset.index),this.products.forEach(o=>{o.style.display=Number(o.dataset.index)==this._productIndex?"block":"none"})})}),this.addToCartBtn.addEventListener("click",e=>{this.handleAddToBtnClick(e)})}get overlay_texts(){return this.querySelectorAll(".overlay-text")}get products(){return this.querySelectorAll(".product-selected")}get addToCartBtn(){return this.querySelector(".add-to-cart-btn")}firstUpdated(){this._mq=window.matchMedia("(max-width: 768px)"),this.handleMediaChange(this._mq),this._mq.addEventListener("change",e=>this.handleMediaChange(e))}handleAddToBtnClick(e){if(e.preventDefault(),this.addToCartBtn.getAttribute("aria-disabled")=="true")return;const o=Array.from(this.products).find(r=>Number(r.dataset.index??0)==this._productIndex),a=Array.from(o.querySelectorAll(".product-item")).map(r=>Number(r.dataset.productId));this.addToCartBtn.classList.add("loading"),this.addToCartBtn.setAttribute("aria-disabled",!0),this.querySelector(".loading__spinner").classList.remove("hidden"),fetch(routes.cart_add_url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:a.map(r=>({id:Number(r),quantity:1}))})}).then(r=>{this.addToCartBtn.classList.remove("loading"),this.querySelector(".loading__spinner").classList.add("hidden"),this.addToCartBtn.removeAttribute("aria-disabled"),window.location=window.routes.cart_url}).catch(r=>{console.error(r)})}handleMediaChange(e){e.matches?this._mySwiper||C(async()=>{const{Swiper:o}=await import("./swiper.js").then(a=>a.f);return{Swiper:o}},[]).then(({Swiper:o})=>{this._mySwiper=new o(this.querySelector(".swiper"),{slidesPerView:"auto",centeredSlides:!0,freeMode:!0})}):this._mySwiper&&(this._mySwiper.destroy(!0,!0),this._mySwiper=null)}render(){return v`<slot></slot>`}}customElements.define("my-promo-split-container",E);
