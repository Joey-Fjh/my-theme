var _=Object.defineProperty;var w=(s,n,e)=>n in s?_(s,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[n]=e;var u=(s,n,e)=>w(s,typeof n!="symbol"?n+"":n,e);import{i as S,x as v}from"./lit-element.js";const g="modulepreload",b=function(s){return"/"+s},p={},C=function(n,e,o){let t=Promise.resolve();if(e&&e.length>0){let a=function(i){return Promise.all(i.map(l=>Promise.resolve(l).then(c=>({status:"fulfilled",value:c}),c=>({status:"rejected",reason:c}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),m=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));t=a(e.map(i=>{if(i=b(i),i in p)return;p[i]=!0;const l=i.endsWith(".css"),c=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${c}`))return;const d=document.createElement("link");if(d.rel=l?"stylesheet":g,l||(d.as="script"),d.crossOrigin="",d.href=i,m&&d.setAttribute("nonce",m),document.head.appendChild(d),l)return new Promise((f,y)=>{d.addEventListener("load",f),d.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${i}`)))})}))}function h(a){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=a,window.dispatchEvent(r),!r.defaultPrevented)throw a}return t.then(a=>{for(const r of a||[])r.status==="rejected"&&h(r.reason);return n().catch(h)})};class E extends S{constructor(){super();u(this,"_mySwiper",null);u(this,"_mq",null);u(this,"_productIndex",1);this.overlay_texts.forEach(e=>{e.addEventListener("click",()=>{this._productIndex=Number(e.dataset.index),this.products.forEach(o=>{o.style.display=Number(o.dataset.index)==this._productIndex?"block":"none"})})}),this.addToCartBtn.addEventListener("click",()=>{this.handleAddToBtnClick()})}get overlay_texts(){return this.querySelectorAll(".overlay-text")}get products(){return this.querySelectorAll(".product-selected")}get addToCartBtn(){return this.querySelector(".add-to-cart-btn")}firstUpdated(){this._mq=window.matchMedia("(max-width: 768px)"),this.handleMediaChange(this._mq),this._mq.addEventListener("change",e=>this.handleMediaChange(e))}handleAddToBtnClick(){const e=Array.from(this.products).find(t=>Number(t.dataset.index??0)==this._productIndex),o=Array.from(e.querySelectorAll(".product-item")).map(t=>Number(t.dataset.productId));this.addToCartBtn.classList.add("loading"),this.addToCartBtn.setAttribute("aria-disabled",!0),this.querySelector(".loading__spinner").classList.remove("hidden"),fetch(routes.cart_add_url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:o.map(t=>({id:Number(t),quantity:1}))})}).then(t=>{this.addToCartBtn.classList.remove("loading"),this.querySelector(".loading__spinner").classList.add("hidden"),this.addToCartBtn.removeAttribute("aria-disabled"),window.location=window.routes.cart_url}).catch(t=>{console.error(t)})}handleMediaChange(e){e.matches?this._mySwiper||C(async()=>{const{Swiper:o}=await import("./swiper.js").then(t=>t.f);return{Swiper:o}},[]).then(({Swiper:o})=>{this._mySwiper=new o(this.querySelector(".swiper"),{slidesPerView:"auto",centeredSlides:!0,freeMode:!0})}):this._mySwiper&&(this._mySwiper.destroy(!0,!0),this._mySwiper=null)}render(){return v`<slot></slot>`}}customElements.define("my-promo-split-container",E);
