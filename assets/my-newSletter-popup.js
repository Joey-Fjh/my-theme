var r=Object.defineProperty;var h=(t,e,i)=>e in t?r(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var s=(t,e,i)=>h(t,typeof e!="symbol"?e+"":e,i);import{i as n,x as l}from"./lit-element.js";class o extends n{constructor(){super(),this.displayMode="enable",this.showInHome=!0,this.showForVisitor=!0,this.delay=3,this.expired=7,this.expiredTimeStamp=0,this.open=!1,this.timeId=null,this.storageKey="newsletter-popup-expired"}connectedCallback(){super.connectedCallback(),this.overlayDom=this.querySelector(".overlay"),this.closeBtnDom=this.querySelector(".newsletter-close"),this.init()}disconnectedCallback(){super.disconnectedCallback(),clearTimeout(this.timeId),[this.overlayDom,this.closeBtnDom].forEach(e=>{e&&e.removeEventListener("click",this.handleClick.bind(this))})}handleClick(){this.hide()}init(){if(this.displayMode=="enable"){if(!this.judgeShow())return;this.isExpired()&&(this.expiredTimeStamp=Date.now()+this.expired*24*60*60*1e3,localStorage.setItem(this.storageKey,this.expiredTimeStamp))}[this.overlayDom,this.closeBtnDom].forEach(e=>{e&&e.addEventListener("click",this.handleClick.bind(this))}),this.displayMode=="enable"?this.timeId=setTimeout(()=>{this.show()},this.delay*1e3):this.show()}isExpired(){const e=Number(localStorage.getItem(this.storageKey)),i=Date.now();return!e||i>e}judgeShow(){return!(!this.showInHome||!this.showForVisitor||!this.isExpired())}show(){this.open=!0,this.setAttribute("open","true")}hide(){this.open=!1,this.removeAttribute("open")}render(){return l`<slot></slot>`}}s(o,"properties",{displayMode:{type:String},showInHome:{type:Boolean},showForVisitor:{type:Boolean},delay:{type:Number},expired:{type:Number}});customElements.define("newsletter-popup",o);
